<html>

<head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="generator" content="HTML Tidy for Linux/x86 (vers 11 February 2007), see www.w3.org">
  <style type="text/css">
    /* Color scheme stolen from Sergey Karayev */
    a {
    color: #07889b; /*#1772d0;*/
    text-decoration:none;
    }
    a:focus, a:hover {
    color: #e37222; /*#f7b733;*/ /*f09228;*/
    text-decoration:none;
    }
    body,td,th,tr,p,a {
    font-family: "TeXGyrePagella", "Palatino Linotype", "Book Antiqua", Palatino, serif; /*'Lato', Verdana, Helvetica, sans-serif;*/
    font-size: 15px; /*14*/
    }
    strong {
    font-family: "TeXGyrePagella", "Palatino Linotype", "Book Antiqua", Palatino, serif; /*'Lato', Verdana, Helvetica, sans-serif;*/
    font-size: 15px; /*14*/
    }
    heading {
    font-family: "TeXGyrePagella", "Palatino Linotype", "Book Antiqua", Palatino, serif; /*'Lato', Verdana, Helvetica, sans-serif;*/
    font-size: 22px;
    color: #e37222; /*#fc4a1a;*/
    }
    heading2 {
    font-family: "TeXGyrePagella", "Palatino Linotype", "Book Antiqua", Palatino, serif; /*'Lato', Verdana, Helvetica, sans-serif;*/
    font-size: 18px;
    }
    papertitle {
    font-family: "TeXGyrePagella", "Palatino Linotype", "Book Antiqua", Palatino, serif; /*'Lato', Verdana, Helvetica, sans-serif;*/
    font-size: 15px; /*14*/
    font-weight: 700;
    }
    name {
    font-family: "TeXGyrePagella", "Palatino Linotype", "Book Antiqua", Palatino, serif; /*'Lato', Verdana, Helvetica, sans-serif;*/
    font-size: 42px;
    }
    li:not(:last-child) {
        margin-bottom: 5px;
    }
    .one
    {
    width: 160px;
    height: 160px;
    position: relative;
    }
    .two
    {
    width: 160px;
    height: 160px;
    position: absolute;
    transition: opacity .2s ease-in-out;
    -moz-transition: opacity .2s ease-in-out;
    -webkit-transition: opacity .2s ease-in-out;
    }
    .fade {
     transition: opacity .2s ease-in-out;
     -moz-transition: opacity .2s ease-in-out;
     -webkit-transition: opacity .2s ease-in-out;
    }
    span.highlight {
        background-color: #ffffd0;
    }
  </style>  

<title>Benjamin Scellier</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
  <link href="./_files/css" rel="stylesheet" type="text/css">
  <style id="dark-reader-style" type="text/css">@media screen {

/* Leading rule */
/*html {
  -webkit-filter: brightness(100%) contrast(100%) grayscale(20%) sepia(10%) !important;
}*/

/* Text contrast */
html {
  text-shadow: 0 0 0 !important;
}

/* Full screen */
*:-webkit-full-screen, *:-webkit-full-screen * {
  -webkit-filter: none !important;
}

/* Page background */
html {
  background: rgb(255,255,255) !important;
}

}</style>

<script type="text/javascript">
   function visibility_on(id) {
        var e = document.getElementById(id+"_text");
        if(e.style.display == 'none')
            e.style.display = 'block';
        var e = document.getElementById(id+"_img");
        if(e.style.display == 'none')
            e.style.display = 'block';
   }
   function visibility_off(id) {
        var e = document.getElementById(id+"_text");
        if(e.style.display == 'block')
            e.style.display = 'none';
        var e = document.getElementById(id+"_img");
        if(e.style.display == 'block')
            e.style.display = 'none';
   }
   function toggle_visibility(id) {
       var e = document.getElementById(id+"_text");
       if(e.style.display == 'inline')
          e.style.display = 'block';
       else
          e.style.display = 'inline';
       var e = document.getElementById(id+"_img");
       if(e.style.display == 'inline')
          e.style.display = 'block';
       else
          e.style.display = 'inline';
   }
   function toggle_vis(id) {
       var e = document.getElementById(id);
       if (e.style.display == 'none')
           e.style.display = 'inline';
       else
           e.style.display = 'none';
   }
</script>

</head>


    <body>
        <div id="StayFocusd-infobar" style="display: none; top: 2400px;">
        <img src="chrome-extension://laankejkbhbdhmipfmgcngdelahlfoji/common/img/eye_19x19_red.png">
        <span id="StayFocusd-infobar-msg"></span>
        <span id="StayFocusd-infobar-links">
            <a id="StayFocusd-infobar-never-show">hide forever</a>&nbsp;&nbsp;|&nbsp;&nbsp;
            <a id="StayFocusd-infobar-hide">hide once</a>
        </span>
        </div>
            <table width="100%" align="center" border="0" cellspacing="0" cellpadding="20">
            <heading>Proof of the Eqprop Formula</heading>
            <tbody>
                <tr>
                    <td>
                        <h3 class="card-subheading">Lemma</h3>
                        <p>
                        Let \(F(\theta, \beta, s)\) be a twice differentiable function of the three variables \(\theta\), \(\beta\) and \(s\). Let \(\overline{s}\) be a stationarity point of \(F(\overline{\theta}, \overline{\beta}, \cdot)\), i.e.
                        \( \frac{\partial F}{\partial s}(\overline{\theta}, \overline{\beta}, \overline{s}) = 0\),
                        and suppose that \(\frac{\partial^2 F}{\partial s^2}(\overline{\theta}, \overline{\beta}, \overline{s})\) is invertible. Then, there exists a neighborhood of \((\overline{\theta}, \overline{\beta})\) and a continuously differentiable function \((\theta, \beta) \mapsto s_\theta^\beta\) defined in this neighborhood, such that \(s_{\overline{\theta}}^{\overline{\beta}} = \overline{s}\) and
                        \begin{equation}
                        \frac{\partial F}{\partial s}(\theta, \beta, s_\theta^\beta) = 0
                        \end{equation}
                        for every \((\theta\), \(\beta\)). Furthermore, we have the following identity:
                        \begin{equation}
                        \frac{d}{d\theta} \frac{\partial F}{\partial \beta}(\theta, \beta, s_\theta^\beta) = \frac{d}{d\beta} \frac{\partial F}{\partial \theta}(\theta, \beta, s_\theta^\beta).
                        \end{equation}
                        </p>

                        <h3 class="card-subheading">Proof of the lemma</h3>
                        <p>
                        The first statement follows from the implicit function theorem. It remains to prove the formula. Let us consider \(F \left(\theta, \beta, s_\theta^\beta \right)\) as a function of \((\theta, \beta)\). Using the chain rule of differentiation and the stationary condition, we have
                        \begin{equation}
                          \frac{d}{d\beta} F(\theta, \beta, s_\theta^\beta) = \frac{\partial F}{\partial \beta} \left( \theta, \beta, s_\theta^\beta \right)
                          + \underbrace{\frac{\partial F}{\partial s} \left( \theta, \beta, s_\theta^\beta \right)}_{= \; 0} \cdot \frac{\partial s_\theta^\beta}{\partial \beta}.
                        \end{equation}
                        Similarly, we have
                        \begin{equation}
                          \frac{d}{d\theta} F(\theta, \beta, s_\theta^\beta) = \frac{\partial F}{\partial \theta} \left( \theta, \beta, s_\theta^\beta \right)
                          + \underbrace{\frac{\partial F}{\partial s} \left( \theta, \beta, s_\theta^\beta \right)}_{= \; 0} \cdot \frac{\partial s_\theta^\beta}{\partial \theta}.
                        \end{equation}
                        Combining these equations and using the symmetry of second-derivatives, we get:
                        \begin{equation}
                        \frac{d}{d\theta} \frac{\partial F}{\partial \beta}(\theta, \beta, s_\theta^\beta) = \frac{d}{d\theta} \frac{d}{d\beta} F(\theta, \beta, s_\theta^\beta) =  \frac{d}{d\beta} \frac{d}{d\theta} F(\theta, \beta, s_\theta^\beta) = \frac{d}{d\beta} \frac{\partial F}{\partial \theta}(\theta, \beta, s_\theta^\beta).
                        \end{equation}
                        </p>

                        <h3 class="card-subheading">Proof of the <a href="eqprop-formula.html">equilibrium propagation formula</a></h3>
                        <p>
                        Consider the function \(F(\theta, \beta, s) = E(\theta, x, s) + \beta C(s, y)\) given a fixed input-target pair \((x, y)\). Applying the lemma to this function \(F\), we get
                        \begin{equation}
                            \frac{d}{d\theta} C(s_\theta^\beta,y) = \frac{d}{d\beta} \frac{\partial E}{\partial \theta}(\theta, x, s_\theta^\beta).
                        \end{equation}
                        Evaluating this equation at the point \(\beta=0\), we obtain the Eqprop formula.
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>
    </body>
</html>